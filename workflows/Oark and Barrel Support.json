{
  "name": "Oark and Barrel Support",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        0,
        0
      ],
      "id": "2589c7c3-1ff6-41fd-ad0c-0f63f5413a36",
      "name": "When chat message received",
      "webhookId": "5c98b1fe-7448-4167-ab9f-7519f0f6cc96"
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "=Your name is Luna, a customer agent for a restuarant called the Oak & Barrel.\n\nYour role is to answer questions about restaurant by using the Oak and Barrel knowledge base tool.\n\nYour responses should be friendly and concise.\n\nIf a userrequests to make a reseravtion, you need to do the following:\n- Collect their name , email, party size, date and time and any special requirements (optional)\n- Use the Make Reservation tool to send an email to the restaurant to make the reservation.\n- Inform the user that their request was sent to the restaurant and the the restaurant will confirm the reservation.\n\nif a user needs to speak to a human, you need to do the following:\n - Collect their name, email or phone number.\n - Send an email using Request Human Support tool.\n\n - Inform the the user that their request was sent to the restaurant and someone will get in touch soon."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        208,
        0
      ],
      "id": "ed0a90a0-8ce0-4282-8b18-e49bcab8d474",
      "name": "Luna"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -176,
        240
      ],
      "id": "d97d580b-9962-4828-bd6d-d868b36d4a4c",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "EFS3MruGpyRsutgh",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
      "typeVersion": 1,
      "position": [
        128,
        416
      ],
      "id": "c3023b76-b830-4ac2-bdc9-8529bbec739a",
      "name": "Embeddings Google Gemini",
      "credentials": {
        "googlePalmApi": {
          "id": "5srS6Jd32VkQUKyt",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "shadrackssenkaayi21@gmail.com",
        "subject": "New Reservation",
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        544,
        272
      ],
      "id": "e28a6003-3f51-4a04-b468-245d6aa953cb",
      "name": "Make Reservations",
      "webhookId": "1f837f5a-ba65-4d0f-8f80-de8ed6569e06",
      "credentials": {
        "gmailOAuth2": {
          "id": "Zr7FysiBIEOkHjaL",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "shadrackssenkaayi21@gmail.com",
        "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}",
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        704,
        272
      ],
      "id": "43f4efca-61c9-4ccf-a832-e402df065d9a",
      "name": "Request Human Support",
      "webhookId": "c3705cbc-c05d-49db-a3ac-9005d3e5a090",
      "credentials": {
        "gmailOAuth2": {
          "id": "Zr7FysiBIEOkHjaL",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryPostgresChat",
      "typeVersion": 1.3,
      "position": [
        16,
        272
      ],
      "id": "7c70c382-319f-47a1-bbfb-149e5797628d",
      "name": "Postgres Chat Memory",
      "credentials": {
        "postgres": {
          "id": "kD6yMzcOzM9QvdeV",
          "name": "Postgres account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolDescription": "Use this to retrieve documents related to the Oak and Barrel",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStorePGVector",
      "typeVersion": 1.3,
      "position": [
        192,
        208
      ],
      "id": "2ccd351d-9067-4b4a-9c16-e6b688b973b1",
      "name": "Postgres PGVector Store",
      "credentials": {
        "postgres": {
          "id": "kD6yMzcOzM9QvdeV",
          "name": "Postgres account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "Luna",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Luna",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Google Gemini": {
      "ai_embedding": [
        [
          {
            "node": "Postgres PGVector Store",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Make Reservations": {
      "ai_tool": [
        [
          {
            "node": "Luna",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Request Human Support": {
      "ai_tool": [
        [
          {
            "node": "Luna",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Postgres Chat Memory": {
      "ai_memory": [
        [
          {
            "node": "Luna",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Postgres PGVector Store": {
      "ai_tool": [
        [
          {
            "node": "Luna",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "c46a683a-6a9e-4a40-abdb-0ae90351855b",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "4a6e244da7ea40c2c7ded40d02bf025a61a833c5ee3271fe5a06a9f6cdfe37ad"
  },
  "id": "KGniTD4fRoV1IrwC",
  "tags": []
}